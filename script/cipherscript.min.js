"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0==this.indexOf(a)});"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){for(var a=this.replace(/^\s\s*/,""),b=/\s/,c=a.length;b.test(a.charAt(--c)););return a.slice(0,c+1)});
"function"!=typeof String.prototype.between&&(String.prototype.between=function(a,b){var c=this.indexOf(a),d=this.substr(c).indexOf(b),d=c+d;return-1!=c&&-1!=d?(c+=a.length,this.substr(c,this.length-(this.length-d)-c)):null});var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
h=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||m).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<
32-8*(c%4);b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new h.init(c,b)}}),l=c.enc={},m=l.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,
2),16)<<24-4*(d%8);return new h.init(c,b/2)}},g=l.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new h.init(c,b)}},p=l.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},
q=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=p.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,g=e/(4*f),g=b?a.ceil(g):a.max((g|0)-this._minBufferSize,0);b=g*f;e=a.min(4*b,e);if(b){for(var l=0;l<b;l+=f)this._doProcessBlock(d,l);l=d.splice(0,b);c.sigBytes-=e}return new h.init(l,e)},clone:function(){var a=f.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=q.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new x.HMAC.init(a,
c)).finalize(b)}}});var x=c.algo={};return c}(Math);(function(){var a=CryptoJS,b=a.lib.WordArray,a=a.enc;a.Utf16=a.Utf16BE={stringify:function(a){var b=a.words;a=a.sigBytes;for(var e=[],f=0;f<a;f+=2)e.push(String.fromCharCode(b[f>>>2]>>>16-8*(f%4)&65535));return e.join("")},parse:function(a){for(var d=a.length,e=[],f=0;f<d;f++)e[f>>>1]|=a.charCodeAt(f)<<16-16*(f%2);return b.create(e,2*d)}};a.Utf16LE={stringify:function(a){var b=a.words;a=a.sigBytes;for(var e=[],f=0;f<a;f+=2)e.push(String.fromCharCode((b[f>>>2]>>>16-8*(f%4)&65535)<<8&4278255360|(b[f>>>
2]>>>16-8*(f%4)&65535)>>>8&16711935));return e.join("")},parse:function(a){for(var d=a.length,e=[],f=0;f<d;f++){var h=e,l=f>>>1,m=h[l],g=a.charCodeAt(f)<<16-16*(f%2);h[l]=m|g<<8&4278255360|g>>>8&16711935}return b.create(e,2*d)}}})();(function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,e=a.sigBytes,f=this._map;a.clamp();a=[];for(var h=0;h<e;h+=3)for(var l=(b[h>>>2]>>>24-8*(h%4)&255)<<16|(b[h+1>>>2]>>>24-8*((h+1)%4)&255)<<8|b[h+2>>>2]>>>24-8*((h+2)%4)&255,m=0;4>m&&h+0.75*m<e;m++)a.push(f.charAt(l>>>6*(3-m)&63));if(b=f.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var d=a.length,e=this._map,f=e.charAt(64);f&&(f=a.indexOf(f),-1!=f&&(d=f));for(var f=[],h=0,l=0;l<
d;l++)if(l%4){var m=e.indexOf(a.charAt(l-1))<<2*(l%4),g=e.indexOf(a.charAt(l))>>>6-2*(l%4);f[h>>>2]|=(m|g)<<24-8*(h%4);h++}return b.create(f,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
h=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||m).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<
32-8*(c%4);b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new h.init(c,b)}}),l=c.enc={},m=l.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,
2),16)<<24-4*(d%8);return new h.init(c,b/2)}},g=l.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new h.init(c,b)}},p=l.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},
q=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=p.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,g=e/(4*f),g=b?a.ceil(g):a.max((g|0)-this._minBufferSize,0);b=g*f;e=a.min(4*b,e);if(b){for(var l=0;l<b;l+=f)this._doProcessBlock(d,l);l=d.splice(0,b);c.sigBytes-=e}return new h.init(l,e)},clone:function(){var a=f.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=q.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new x.HMAC.init(a,
c)).finalize(b)}}});var x=c.algo={};return c}(Math);
(function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,b=b.x64={};b.Word=d.extend({init:function(a,b){this.high=a;this.low=b}});b.WordArray=d.extend({init:function(b,c){b=this.words=b||[];this.sigBytes=c!=a?c:8*b.length},toX32:function(){for(var a=this.words,b=a.length,c=[],d=0;d<b;d++){var g=a[d];c.push(g.high);c.push(g.low)}return e.create(c,this.sigBytes)},clone:function(){for(var a=d.clone.call(this),b=a.words=this.words.slice(0),c=b.length,e=0;e<c;e++)b[e]=b[e].clone();return a}})})();
(function(){function a(){return e.create.apply(e,arguments)}for(var b=CryptoJS,c=b.lib.Hasher,d=b.x64,e=d.Word,f=d.WordArray,d=b.algo,h=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),
a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,
2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),
a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,
3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],l=[],m=0;80>m;m++)l[m]=a();d=d.SHA512=c.extend({_doReset:function(){this._hash=new f.init([new e.init(1779033703,4089235720),new e.init(3144134277,2227873595),new e.init(1013904242,4271175723),new e.init(2773480762,1595750129),new e.init(1359893119,2917565137),new e.init(2600822924,725511199),new e.init(528734635,4215389547),new e.init(1541459225,327033209)])},_doProcessBlock:function(a,b){for(var c=this._hash.words,
d=c[0],e=c[1],f=c[2],y=c[3],D=c[4],A=c[5],m=c[6],c=c[7],N=d.high,G=d.low,B=e.high,I=e.low,V=f.high,Q=f.low,W=y.high,R=y.low,X=D.high,S=D.low,Y=A.high,r=A.low,u=m.high,t=m.low,v=c.high,ha=c.low,J=N,E=G,ba=B,$=I,ca=V,aa=Q,ka=W,da=R,K=X,F=S,ia=Y,ea=r,ja=u,fa=t,la=v,ga=ha,L=0;80>L;L++){var T=l[L];if(16>L)var H=T.high=a[b+2*L]|0,z=T.low=a[b+2*L+1]|0;else{var H=l[L-15],z=H.high,O=H.low,H=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),Z=l[L-2],z=Z.high,C=Z.low,Z=(z>>>19|C<<
13)^(z<<3|C>>>29)^z>>>6,C=(C>>>19|z<<13)^(C<<3|z>>>29)^(C>>>6|z<<26),z=l[L-7],ma=z.high,U=l[L-16],P=U.high,U=U.low,z=O+z.low,H=H+ma+(z>>>0<O>>>0?1:0),z=z+C,H=H+Z+(z>>>0<C>>>0?1:0),z=z+U,H=H+P+(z>>>0<U>>>0?1:0);T.high=H;T.low=z}var ma=K&ia^~K&ja,U=F&ea^~F&fa,T=J&ba^J&ca^ba&ca,oa=E&$^E&aa^$&aa,O=(J>>>28|E<<4)^(J<<30|E>>>2)^(J<<25|E>>>7),Z=(E>>>28|J<<4)^(E<<30|J>>>2)^(E<<25|J>>>7),C=h[L],pa=C.high,na=C.low,C=ga+((F>>>14|K<<18)^(F>>>18|K<<14)^(F<<23|K>>>9)),P=la+((K>>>14|F<<18)^(K>>>18|F<<14)^(K<<23|
F>>>9))+(C>>>0<ga>>>0?1:0),C=C+U,P=P+ma+(C>>>0<U>>>0?1:0),C=C+na,P=P+pa+(C>>>0<na>>>0?1:0),C=C+z,P=P+H+(C>>>0<z>>>0?1:0),z=Z+oa,T=O+T+(z>>>0<Z>>>0?1:0),la=ja,ga=fa,ja=ia,fa=ea,ia=K,ea=F,F=da+C|0,K=ka+P+(F>>>0<da>>>0?1:0)|0,ka=ca,da=aa,ca=ba,aa=$,ba=J,$=E,E=C+z|0,J=P+T+(E>>>0<C>>>0?1:0)|0}G=d.low=G+E;d.high=N+J+(G>>>0<E>>>0?1:0);I=e.low=I+$;e.high=B+ba+(I>>>0<$>>>0?1:0);Q=f.low=Q+aa;f.high=V+ca+(Q>>>0<aa>>>0?1:0);R=y.low=R+da;y.high=W+ka+(R>>>0<da>>>0?1:0);S=D.low=S+F;D.high=X+K+(S>>>0<F>>>0?1:0);
r=A.low=r+ea;A.high=Y+ia+(r>>>0<ea>>>0?1:0);t=m.low=t+fa;m.high=u+ja+(t>>>0<fa>>>0?1:0);ha=c.low=ha+ga;c.high=v+la+(ha>>>0<ga>>>0?1:0)},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+128>>>10<<5)+30]=Math.floor(c/4294967296);b[(d+128>>>10<<5)+31]=c;a.sigBytes=4*b.length;this._process();return this._hash.toX32()},clone:function(){var a=c.clone.call(this);a._hash=this._hash.clone();return a},blockSize:32});b.SHA512=c._createHelper(d);
b.HmacSHA512=c._createHmacHelper(d)})();CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
h=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||m).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<
32-8*(c%4);b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new h.init(c,b)}}),l=c.enc={},m=l.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,
2),16)<<24-4*(d%8);return new h.init(c,b/2)}},g=l.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new h.init(c,b)}},p=l.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},
q=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=p.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,g=e/(4*f),g=b?a.ceil(g):a.max((g|0)-this._minBufferSize,0);b=g*f;e=a.min(4*b,e);if(b){for(var l=0;l<b;l+=f)this._doProcessBlock(d,l);l=d.splice(0,b);c.sigBytes-=e}return new h.init(l,e)},clone:function(){var a=f.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=q.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new x.HMAC.init(a,
c)).finalize(b)}}});var x=c.algo={};return c}(Math);
(function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,b=b.x64={};b.Word=d.extend({init:function(a,b){this.high=a;this.low=b}});b.WordArray=d.extend({init:function(b,c){b=this.words=b||[];this.sigBytes=c!=a?c:8*b.length},toX32:function(){for(var a=this.words,b=a.length,c=[],d=0;d<b;d++){var g=a[d];c.push(g.high);c.push(g.low)}return e.create(c,this.sigBytes)},clone:function(){for(var a=d.clone.call(this),b=a.words=this.words.slice(0),c=b.length,e=0;e<c;e++)b[e]=b[e].clone();return a}})})();
(function(a){for(var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,f=b.x64.Word,c=b.algo,h=[],l=[],m=[],g=1,p=0,q=0;24>q;q++){h[g+5*p]=(q+1)*(q+2)/2%64;var x=(2*g+3*p)%5,g=p%5,p=x}for(g=0;5>g;g++)for(p=0;5>p;p++)l[g+5*p]=p+5*((2*g+3*p)%5);g=1;for(p=0;24>p;p++){for(var n=x=q=0;7>n;n++){if(g&1){var w=(1<<n)-1;32>w?x^=1<<w:q^=1<<w-32}g=g&128?g<<1^113:g<<1}m[p]=f.create(q,x)}for(var y=[],g=0;25>g;g++)y[g]=f.create();c=c.SHA3=e.extend({cfg:e.cfg.extend({outputLength:512}),_doReset:function(){for(var a=this._state=
[],b=0;25>b;b++)a[b]=new f.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,b){for(var c=this._state,d=this.blockSize/2,e=0;e<d;e++){var f=a[b+2*e],g=a[b+2*e+1],f=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,n=c[e];n.high^=g;n.low^=f}for(d=0;24>d;d++){for(e=0;5>e;e++){for(var q=f=0,w=0;5>w;w++)n=c[e+5*w],f^=n.high,q^=n.low;n=y[e];n.high=f;n.low=q}for(e=0;5>e;e++){n=y[(e+4)%5];f=y[(e+1)%5];g=f.high;w=f.low;f=n.high^
(g<<1|w>>>31);q=n.low^(w<<1|g>>>31);for(w=0;5>w;w++)n=c[e+5*w],n.high^=f,n.low^=q}for(g=1;25>g;g++)n=c[g],e=n.high,n=n.low,w=h[g],32>w?(f=e<<w|n>>>32-w,q=n<<w|e>>>32-w):(f=n<<w-32|e>>>64-w,q=e<<w-32|n>>>64-w),n=y[l[g]],n.high=f,n.low=q;n=y[0];e=c[0];n.high=e.high;n.low=e.low;for(e=0;5>e;e++)for(w=0;5>w;w++)g=e+5*w,n=c[g],f=y[g],g=y[(e+1)%5+5*w],q=y[(e+2)%5+5*w],n.high=f.high^~g.high&q.high,n.low=f.low^~g.low&q.low;n=c[0];e=m[d];n.high^=e.high;n.low^=e.low}},_doFinalize:function(){var b=this._data,
c=b.words,e=8*b.sigBytes,f=32*this.blockSize;c[e>>>5]|=1<<24-e%32;c[(a.ceil((e+1)/f)*f>>>5)-1]|=128;b.sigBytes=4*c.length;this._process();for(var b=this._state,c=this.cfg.outputLength/8,e=c/8,f=[],n=0;n<e;n++){var g=b[n],h=g.high,g=g.low,h=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360;f.push(g);f.push(h)}return new d.init(f,c)},clone:function(){for(var a=e.clone.call(this),b=a._state=this._state.slice(0),c=0;25>c;c++)b[c]=b[c].clone();return a}});
b.SHA3=e._createHelper(c);b.HmacSHA3=e._createHmacHelper(c)})(Math);CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
h=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||m).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<
32-8*(c%4);b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new h.init(c,b)}}),l=c.enc={},m=l.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,
2),16)<<24-4*(d%8);return new h.init(c,b/2)}},g=l.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new h.init(c,b)}},p=l.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},
q=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=p.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,g=e/(4*f),g=b?a.ceil(g):a.max((g|0)-this._minBufferSize,0);b=g*f;e=a.min(4*b,e);if(b){for(var l=0;l<b;l+=f)this._doProcessBlock(d,l);l=d.splice(0,b);c.sigBytes-=e}return new h.init(l,e)},clone:function(){var a=f.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=q.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new x.HMAC.init(a,
c)).finalize(b)}}});var x=c.algo={};return c}(Math);
(function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,e=a.sigBytes,f=this._map;a.clamp();a=[];for(var h=0;h<e;h+=3)for(var l=(b[h>>>2]>>>24-8*(h%4)&255)<<16|(b[h+1>>>2]>>>24-8*((h+1)%4)&255)<<8|b[h+2>>>2]>>>24-8*((h+2)%4)&255,m=0;4>m&&h+0.75*m<e;m++)a.push(f.charAt(l>>>6*(3-m)&63));if(b=f.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var d=a.length,e=this._map,f=e.charAt(64);f&&(f=a.indexOf(f),-1!=f&&(d=f));for(var f=[],h=0,l=0;l<
d;l++)if(l%4){var m=e.indexOf(a.charAt(l-1))<<2*(l%4),g=e.indexOf(a.charAt(l))>>>6-2*(l%4);f[h>>>2]|=(m|g)<<24-8*(h%4);h++}return b.create(f,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
(function(a){function b(a,b,c,d,e,f,g){a=a+(b&c|~b&d)+e+g;return(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){a=a+(b&d|c&~d)+e+g;return(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){a=a+(b^c^d)+e+g;return(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){a=a+(c^(b|~d))+e+g;return(a<<f|a>>>32-f)+b}for(var f=CryptoJS,h=f.lib,l=h.WordArray,m=h.Hasher,h=f.algo,g=[],p=0;64>p;p++)g[p]=4294967296*a.abs(a.sin(p+1))|0;h=h.MD5=m.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},
_doProcessBlock:function(a,f){for(var h=0;16>h;h++){var l=f+h,y=a[l];a[l]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var h=this._hash.words,l=a[f+0],y=a[f+1],m=a[f+2],p=a[f+3],M=a[f+4],N=a[f+5],G=a[f+6],B=a[f+7],I=a[f+8],V=a[f+9],Q=a[f+10],W=a[f+11],R=a[f+12],X=a[f+13],S=a[f+14],Y=a[f+15],r=h[0],u=h[1],t=h[2],v=h[3],r=b(r,u,t,v,l,7,g[0]),v=b(v,r,u,t,y,12,g[1]),t=b(t,v,r,u,m,17,g[2]),u=b(u,t,v,r,p,22,g[3]),r=b(r,u,t,v,M,7,g[4]),v=b(v,r,u,t,N,12,g[5]),t=b(t,v,r,u,G,17,g[6]),u=b(u,t,v,r,B,22,g[7]),
r=b(r,u,t,v,I,7,g[8]),v=b(v,r,u,t,V,12,g[9]),t=b(t,v,r,u,Q,17,g[10]),u=b(u,t,v,r,W,22,g[11]),r=b(r,u,t,v,R,7,g[12]),v=b(v,r,u,t,X,12,g[13]),t=b(t,v,r,u,S,17,g[14]),u=b(u,t,v,r,Y,22,g[15]),r=c(r,u,t,v,y,5,g[16]),v=c(v,r,u,t,G,9,g[17]),t=c(t,v,r,u,W,14,g[18]),u=c(u,t,v,r,l,20,g[19]),r=c(r,u,t,v,N,5,g[20]),v=c(v,r,u,t,Q,9,g[21]),t=c(t,v,r,u,Y,14,g[22]),u=c(u,t,v,r,M,20,g[23]),r=c(r,u,t,v,V,5,g[24]),v=c(v,r,u,t,S,9,g[25]),t=c(t,v,r,u,p,14,g[26]),u=c(u,t,v,r,I,20,g[27]),r=c(r,u,t,v,X,5,g[28]),v=c(v,r,
u,t,m,9,g[29]),t=c(t,v,r,u,B,14,g[30]),u=c(u,t,v,r,R,20,g[31]),r=d(r,u,t,v,N,4,g[32]),v=d(v,r,u,t,I,11,g[33]),t=d(t,v,r,u,W,16,g[34]),u=d(u,t,v,r,S,23,g[35]),r=d(r,u,t,v,y,4,g[36]),v=d(v,r,u,t,M,11,g[37]),t=d(t,v,r,u,B,16,g[38]),u=d(u,t,v,r,Q,23,g[39]),r=d(r,u,t,v,X,4,g[40]),v=d(v,r,u,t,l,11,g[41]),t=d(t,v,r,u,p,16,g[42]),u=d(u,t,v,r,G,23,g[43]),r=d(r,u,t,v,V,4,g[44]),v=d(v,r,u,t,R,11,g[45]),t=d(t,v,r,u,Y,16,g[46]),u=d(u,t,v,r,m,23,g[47]),r=e(r,u,t,v,l,6,g[48]),v=e(v,r,u,t,B,10,g[49]),t=e(t,v,r,u,
S,15,g[50]),u=e(u,t,v,r,N,21,g[51]),r=e(r,u,t,v,R,6,g[52]),v=e(v,r,u,t,p,10,g[53]),t=e(t,v,r,u,Q,15,g[54]),u=e(u,t,v,r,y,21,g[55]),r=e(r,u,t,v,I,6,g[56]),v=e(v,r,u,t,Y,10,g[57]),t=e(t,v,r,u,G,15,g[58]),u=e(u,t,v,r,X,21,g[59]),r=e(r,u,t,v,M,6,g[60]),v=e(v,r,u,t,W,10,g[61]),t=e(t,v,r,u,m,15,g[62]),u=e(u,t,v,r,V,21,g[63]);h[0]=h[0]+r|0;h[1]=h[1]+u|0;h[2]=h[2]+t|0;h[3]=h[3]+v|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/
4294967296);c[(e+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;c[(e+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360;b.sigBytes=4*(c.length+1);this._process();b=this._hash;c=b.words;for(d=0;4>d;d++)e=c[d],c[d]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;return b},clone:function(){var a=m.clone.call(this);a._hash=this._hash.clone();return a}});f.MD5=m._createHelper(h);f.HmacMD5=m._createHmacHelper(h)})(Math);
(function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),g=d.create(),p=g.words,q=c.keySize,c=c.iterations;p.length<q;){x&&e.update(x);var x=e.update(a).finalize(b);e.reset();for(var n=1;n<c;n++)x=e.finalize(x),e.reset();g.concat(x)}g.sigBytes=4*q;return g}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,
b)}})();
CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,h=b.enc.Base64,l=b.algo.EvpKDF,m=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){f.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},
finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?w:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?w:n).decrypt(a,b,c,d)}}}});c.StreamCipher=m.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var g=b.mode={},p=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;f<d;f++)b[c+f]^=
e[f]},q=(c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();q.Encryptor=q.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;p.call(this,a,b,d);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+d)}});q.Decryptor=q.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b);p.call(this,
a,b,d);this._prevBlock=e}});g=g.CBC=q;q=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;g<c;g+=4)f.push(d);c=e.create(f,c);a.concat(c)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};c.BlockCipher=m.extend({cfg:m.cfg.extend({mode:g,padding:q}),reset:function(){m.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,
this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var x=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),g=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?e.create([1398893684,
1701076831]).concat(a).concat(b):b).toString(h)},parse:function(a){a=h.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return x.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:g}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);b=e.finalize(b);e=e.cfg;return x.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},
decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){d||(d=e.random(8));a=l.create({keySize:b+c}).compute(a,d);c=e.create(a.words.slice(b),4*c);a.sigBytes=4*b;return x.create({key:a,iv:c,salt:d})}},w=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,
a.keySize,a.ivSize);d.iv=c.iv;a=n.encrypt.call(this,a,b,c.key,d);a.mixIn(c);return a},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=c.iv;return n.decrypt.call(this,a,b,c.key,d)}})}();
(function(){for(var a=CryptoJS,b=a.lib.BlockCipher,c=a.algo,d=[],e=[],f=[],h=[],l=[],m=[],g=[],p=[],q=[],x=[],n=[],w=0;256>w;w++)n[w]=128>w?w<<1:w<<1^283;for(var y=0,D=0,w=0;256>w;w++){var A=D^D<<1^D<<2^D<<3^D<<4,A=A>>>8^A&255^99;d[y]=A;e[A]=y;var M=n[y],N=n[M],G=n[N],B=257*n[A]^16843008*A;f[y]=B<<24|B>>>8;h[y]=B<<16|B>>>16;l[y]=B<<8|B>>>24;m[y]=B;B=16843009*G^65537*N^257*M^16843008*y;g[A]=B<<24|B>>>8;p[A]=B<<16|B>>>16;q[A]=B<<8|B>>>24;x[A]=B;y?(y=M^n[n[n[G^M]]],D^=n[n[D]]):y=D=1}var I=[0,1,2,4,8,
16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],f=0;f<a;f++)if(f<c)e[f]=b[f];else{var h=e[f-1];f%c?6<c&&4==f%c&&(h=d[h>>>24]<<24|d[h>>>16&255]<<16|d[h>>>8&255]<<8|d[h&255]):(h=h<<8|h>>>24,h=d[h>>>24]<<24|d[h>>>16&255]<<16|d[h>>>8&255]<<8|d[h&255],h^=I[f/c|0]<<24);e[f]=e[f-c]^h}b=this._invKeySchedule=[];for(c=0;c<a;c++)f=a-c,h=c%4?e[f]:e[f-4],b[c]=4>c||4>=f?h:g[d[h>>>24]]^p[d[h>>>16&255]]^q[d[h>>>
8&255]]^x[d[h&255]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,f,h,l,m,d)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3];a[b+3]=c;this._doCryptBlock(a,b,this._invKeySchedule,g,p,q,x,e);c=a[b+1];a[b+1]=a[b+3];a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,h,g){for(var l=this._nRounds,m=a[b]^c[0],p=a[b+1]^c[1],n=a[b+2]^c[2],q=a[b+3]^c[3],w=4,x=1;x<l;x++)var y=d[m>>>24]^e[p>>>16&255]^f[n>>>8&255]^h[q&255]^c[w++],A=d[p>>>24]^e[n>>>16&255]^f[q>>>8&255]^h[m&255]^c[w++],B=
d[n>>>24]^e[q>>>16&255]^f[m>>>8&255]^h[p&255]^c[w++],q=d[q>>>24]^e[m>>>16&255]^f[p>>>8&255]^h[n&255]^c[w++],m=y,p=A,n=B;y=(g[m>>>24]<<24|g[p>>>16&255]<<16|g[n>>>8&255]<<8|g[q&255])^c[w++];A=(g[p>>>24]<<24|g[n>>>16&255]<<16|g[q>>>8&255]<<8|g[m&255])^c[w++];B=(g[n>>>24]<<24|g[q>>>16&255]<<16|g[m>>>8&255]<<8|g[p&255])^c[w++];q=(g[q>>>24]<<24|g[m>>>16&255]<<16|g[p>>>8&255]<<8|g[n&255])^c[w++];a[b]=y;a[b+1]=A;a[b+2]=B;a[b+3]=q},keySize:8});a.AES=b._createHelper(c)})();document.addEventListener("touchstart",touchHandler,!0);document.addEventListener("touchmove",touchHandler,!0);document.addEventListener("touchend",touchHandler,!0);document.addEventListener("touchcancel",touchHandler,!0);
function touchHandler(a){var b=a.changedTouches[0],c="";switch(a.type){case "touchstart":c="mousedown";break;case "touchmove":c="mousemove";break;case "touchend":c="mouseup";break;default:return}var d=document.createEvent("MouseEvent");d.initMouseEvent(c,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(d);a.preventDefault()};var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
"undefined"!=typeof module&&module.exports&&(module.exports=sjcl);
sjcl.cipher.aes=function(a){this.k[0][0][0]||this.C();var b,c,d,e,f=this.k[0][4],h=this.k[1];b=a.length;var l=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.c=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^l<<24,l=l<<1^283*(l>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:h[0][f[c>>>24]]^h[1][f[c>>16&255]]^h[2][f[c>>8&255]]^h[3][f[c&
255]]};
sjcl.cipher.aes.prototype={encrypt:function(a){return this.J(a,0)},decrypt:function(a){return this.J(a,1)},k:[[[],[],[],[],[]],[[],[],[],[],[]]],C:function(){var a=this.k[0],b=this.k[1],c=a[4],d=b[4],e,f,h,l=[],m=[],g,p,q,x;for(e=0;256>e;e++)m[(l[e]=e<<1^283*(e>>7))^e]=e;for(f=h=0;!c[f];f^=g||1,h=m[h]||1){q=h^h<<1^h<<2^h<<3^h<<4;q=q>>8^q&255^99;c[f]=q;d[q]=f;p=l[e=l[g=l[f]]];x=16843009*p^65537*e^257*g^16843008*f;p=257*l[q]^16843008*q;for(e=0;4>e;e++)a[e][f]=p=p<<24^p>>>8,b[e][q]=x=x<<24^x>>>8}for(e=
0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)},J:function(a,b){if(4!==a.length)throw new sjcl.exception.invalid("invalid aes block size");var c=this.c[b],d=a[0]^c[0],e=a[b?3:1]^c[1],f=a[2]^c[2];a=a[b?1:3]^c[3];var h,l,m,g=c.length/4-2,p,q=4,x=[0,0,0,0];h=this.k[b];var n=h[0],w=h[1],y=h[2],D=h[3],A=h[4];for(p=0;p<g;p++)h=n[d>>>24]^w[e>>16&255]^y[f>>8&255]^D[a&255]^c[q],l=n[e>>>24]^w[f>>16&255]^y[a>>8&255]^D[d&255]^c[q+1],m=n[f>>>24]^w[a>>16&255]^y[d>>8&255]^D[e&255]^c[q+2],a=n[a>>>24]^w[d>>16&255]^
y[e>>8&255]^D[f&255]^c[q+3],q+=4,d=h,e=l,f=m;for(p=0;4>p;p++)x[b?3&-p:p]=A[d>>>24]<<24^A[e>>16&255]<<16^A[f>>8&255]<<8^A[a&255]^c[q++],h=d,d=e,e=f,f=a,a=h;return x}};
sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.R(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.R(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===
b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b&=31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return!1;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===
c},R:function(a,b,c,d){var e;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},Y:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}};
sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>24),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};
sjcl.hash.sha256=function(a){this.c[0]||this.C();a?(this.o=a.o.slice(0),this.l=a.l.slice(0),this.h=a.h):this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};
sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.o=this.O.slice(0);this.l=[];this.h=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.l=sjcl.bitArray.concat(this.l,a);b=this.h;a=this.h=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512)this.H(c.splice(0,16));return this},finalize:function(){var a,b=this.l,c=this.o,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.h/
4294967296));for(b.push(this.h|0);b.length;)this.H(b.splice(0,16));this.reset();return c},O:[],c:[],C:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b=0,c=2,d;a:for(;64>b;c++){for(d=2;d*d<=c;d++)if(0===c%d)continue a;8>b&&(this.O[b]=a(Math.pow(c,0.5)));this.c[b]=a(Math.pow(c,1/3));b++}},H:function(a){var b,c,d=a.slice(0),e=this.o,f=this.c,h=e[0],l=e[1],m=e[2],g=e[3],p=e[4],q=e[5],x=e[6],n=e[7];for(a=0;64>a;a++)16>a?b=d[a]:(b=d[a+1&15],c=d[a+14&15],b=d[a&15]=(b>>>7^b>>>18^b>>>3^
b<<25^b<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+d[a&15]+d[a+9&15]|0),b=b+n+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(x^p&(q^x))+f[a],n=x,x=q,q=p,p=g+b|0,g=m,m=l,l=h,h=b+(l&m^g&(l^m))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;e[0]=e[0]+h|0;e[1]=e[1]+l|0;e[2]=e[2]+m|0;e[3]=e[3]+g|0;e[4]=e[4]+p|0;e[5]=e[5]+q|0;e[6]=e[6]+x|0;e[7]=e[7]+n|0}};
sjcl.random={randomWords:function(a,b){var c=[];b=this.isReady(b);var d;if(0===b)throw new sjcl.exception.notReady("generator isn't seeded");b&2&&this.X(!(b&1));for(b=0;b<a;b+=4)0===(b+1)%65536&&this.N(),d=this.A(),c.push(d[0],d[1],d[2],d[3]);this.N();return c.slice(0,a)},setDefaultParanoia:function(a){this.v=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),h=this.s[c],l=this.isReady();d=this.I[c];void 0===d&&(d=this.I[c]=this.U++);void 0===h&&(h=this.s[c]=0);this.s[c]=(this.s[c]+
1)%this.f.length;switch(typeof a){case "number":break;case "object":if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e>>>=1;this.f[h].update([d,this.L++,2,b,f,a.length].concat(a));break;case "string":void 0===b&&(b=a.length);this.f[h].update([d,this.L++,3,b,f,a.length]);this.f[h].update(a);break;default:throw new sjcl.exception.bug("random: addEntropy only supports number, array or string");}this.m[h]+=b;this.i+=b;0===l&&(0!==this.isReady()&&this.M("seeded",Math.max(this.j,this.i)),this.M("progress",
this.getProgress()))},isReady:function(a){a=this.F[void 0!==a?a:this.v];return this.j&&this.j>=a?80<this.m[0]&&(new Date).valueOf()>this.Q?3:1:this.i>=a?2:0},getProgress:function(a){a=this.F[a?a:this.v];return this.j>=a?1["0"]:this.i>a?1["0"]:this.i/a},startCollectors:function(){if(!this.n){if(window.addEventListener)window.addEventListener("load",this.p,!1),window.addEventListener("mousemove",this.q,!1);else if(document.attachEvent)document.attachEvent("onload",this.p),document.attachEvent("onmousemove",
this.q);else throw new sjcl.exception.bug("can't attach event");this.n=!0}},stopCollectors:function(){this.n&&(window.removeEventListener?(window.removeEventListener("load",this.p,!1),window.removeEventListener("mousemove",this.q,!1)):window.detachEvent&&(window.detachEvent("onload",this.p),window.detachEvent("onmousemove",this.q)),this.n=!1)},addEventListener:function(a,b){this.t[a][this.T++]=b},removeEventListener:function(a,b){var c;a=this.t[a];var d=[];for(c in a)a.hasOwnProperty(c)&&a[c]===b&&
d.push(c);for(b=0;b<d.length;b++)c=d[b],delete a[c]},f:[new sjcl.hash.sha256],m:[0],D:0,s:{},L:0,I:{},U:0,j:0,i:0,Q:0,c:[0,0,0,0,0,0,0,0],g:[0,0,0,0],u:void 0,v:6,n:!1,t:{progress:{},seeded:{}},T:0,F:[0,48,64,96,128,192,256,384,512,768,1024],A:function(){for(var a=0;4>a&&!(this.g[a]=this.g[a]+1|0,this.g[a]);a++);return this.u.encrypt(this.g)},N:function(){this.c=this.A().concat(this.A());this.u=new sjcl.cipher.aes(this.c)},W:function(a){this.c=sjcl.hash.sha256.hash(this.c.concat(a));this.u=new sjcl.cipher.aes(this.c);
for(a=0;4>a&&!(this.g[a]=this.g[a]+1|0,this.g[a]);a++);},X:function(a){var b=[],c=0,d;this.Q=b[0]=(new Date).valueOf()+3E4;for(d=0;16>d;d++)b.push(4294967296*Math.random()|0);for(d=0;d<this.f.length&&!(b=b.concat(this.f[d].finalize()),c+=this.m[d],this.m[d]=0,!a&&this.D&1<<d);d++);this.D>=1<<this.f.length&&(this.f.push(new sjcl.hash.sha256),this.m.push(0));this.i-=c;c>this.j&&(this.j=c);this.D++;this.W(b)},q:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX,a.y||a.clientY||a.offsetY],
2,"mouse")},p:function(){sjcl.random.addEntropy(new Date,2,"loadtime")},M:function(a,b){var c;a=sjcl.random.t[a];var d=[];for(c in a)a.hasOwnProperty(c)&&d.push(a[c]);for(c=0;c<d.length;c++)d[c](b)}};try{var s=new Uint32Array(32);crypto.getRandomValues(s);sjcl.random.addEntropy(s,1024,"crypto['getRandomValues']")}catch(t$$1){}sjcl.bn=function(a){this.initWith(a)};
sjcl.bn.prototype={radix:24,maxMul:8,d:sjcl.bn,copy:function(){return new this.d(this)},initWith:function(a){var b=0,c;switch(typeof a){case "object":this.limbs=a.limbs.slice(0);break;case "number":this.limbs=[a];this.normalize();break;case "string":a=a.replace(/^0x/,"");this.limbs=[];c=this.radix/4;for(b=0;b<a.length;b+=c)this.limbs.push(parseInt(a.substring(Math.max(a.length-b-c,0),a.length-b),16));break;default:this.limbs=[0]}return this},equals:function(a){"number"===typeof a&&(a=new this.d(a));
var b=0,c;this.fullReduce();a.fullReduce();for(c=0;c<this.limbs.length||c<a.limbs.length;c++)b|=this.getLimb(c)^a.getLimb(c);return 0===b},getLimb:function(a){return a>=this.limbs.length?0:this.limbs[a]},greaterEquals:function(a){"number"===typeof a&&(a=new this.d(a));var b=0,c=0,d,e,f;for(d=Math.max(this.limbs.length,a.limbs.length)-1;0<=d;d--)e=this.getLimb(d),f=a.getLimb(d),c|=f-e&~b,b|=e-f&~c;return(c|~b)>>>31},toString:function(){this.fullReduce();var a="",b,c,d=this.limbs;for(b=0;b<this.limbs.length;b++){for(c=
d[b].toString(16);b<this.limbs.length-1&&6>c.length;)c="0"+c;a=c+a}return"0x"+a},addM:function(a){"object"!==typeof a&&(a=new this.d(a));var b=this.limbs,c=a.limbs;for(a=b.length;a<c.length;a++)b[a]=0;for(a=0;a<c.length;a++)b[a]+=c[a];return this},doubleM:function(){var a,b=0,c,d=this.radix,e=this.radixMask,f=this.limbs;for(a=0;a<f.length;a++)c=f[a],c=c+c+b,f[a]=c&e,b=c>>d;b&&f.push(b);return this},halveM:function(){var a,b=0,c,d=this.radix,e=this.limbs;for(a=e.length-1;0<=a;a--)c=e[a],e[a]=c+b>>
1,b=(c&1)<<d;e[e.length-1]||e.pop();return this},subM:function(a){"object"!==typeof a&&(a=new this.d(a));var b=this.limbs,c=a.limbs;for(a=b.length;a<c.length;a++)b[a]=0;for(a=0;a<c.length;a++)b[a]-=c[a];return this},mod:function(a){a=(new sjcl.bn(a)).normalize();for(var b=(new sjcl.bn(this)).normalize(),c=0;b.greaterEquals(a);c++)a.doubleM();for(;0<c;c--)a.halveM(),b.greaterEquals(a)&&b.subM(a).normalize();return b.trim()},inverseMod:function(a){var b=new sjcl.bn(1),c=new sjcl.bn(0),d=new sjcl.bn(this),
e=new sjcl.bn(a),f,h=1;if(!(a.limbs[0]&1))throw new sjcl.exception.invalid("inverseMod: p must be odd");do{d.limbs[0]&1&&(d.greaterEquals(e)||(f=d,d=e,e=f,f=b,b=c,c=f),d.subM(e),d.normalize(),b.greaterEquals(c)||b.addM(a),b.subM(c));d.halveM();b.limbs[0]&1&&b.addM(a);b.normalize();b.halveM();for(f=h=0;f<d.limbs.length;f++)h|=d.limbs[f]}while(h);if(!e.equals(1))throw new sjcl.exception.invalid("inverseMod: p and x must be relatively prime");return c},add:function(a){return this.copy().addM(a)},sub:function(a){return this.copy().subM(a)},
mul:function(a){"number"===typeof a&&(a=new this.d(a));var b,c=this.limbs,d=a.limbs,e=c.length,f=d.length,h=new this.d,l=h.limbs,m,g=this.maxMul;for(b=0;b<this.limbs.length+a.limbs.length+1;b++)l[b]=0;for(b=0;b<e;b++){m=c[b];for(a=0;a<f;a++)l[b+a]+=m*d[a];--g||(g=this.maxMul,h.cnormalize())}return h.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(a){"number"===typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);var b,c,d=new this.d(1),e=this;for(b=0;b<a.length;b++)for(c=
0;c<this.radix;c++)a[b]&1<<c&&(d=d.mul(e)),e=e.square();return d},mulmod:function(a,b){return this.mod(b).mul(a.mod(b)).mod(b)},powermod:function(a,b){var c=new sjcl.bn(1),d=new sjcl.bn(this);for(a=new sjcl.bn(a);;){a.limbs[0]&1&&(c=c.mulmod(d,b));a.halveM();if(a.equals(0))break;d=d.mulmod(d,b)}return c.normalize().reduce()},trim:function(){var a=this.limbs,b;do b=a.pop();while(a.length&&0===b);a.push(b);return this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var a=
0,b,c=this.ipv,d,e=this.limbs,f=e.length,h=this.radixMask;for(b=0;b<f||0!==a&&-1!==a;b++)a=(e[b]||0)+a,d=e[b]=a&h,a=(a-d)*c;-1===a&&(e[b-1]-=this.placeVal);return this},cnormalize:function(){var a=0,b,c=this.ipv,d,e=this.limbs,f=e.length,h=this.radixMask;for(b=0;b<f-1;b++)a=e[b]+a,d=e[b]=a&h,a=(a-d)*c;e[b]+=a;return this},toBits:function(a){this.fullReduce();a=a||this.exponent||this.limbs.length*this.radix;var b=Math.floor((a-1)/24),c=sjcl.bitArray;a=[c.partial((a+7&-8)%this.radix||this.radix,this.getLimb(b))];
for(b--;0<=b;b--)a=c.concat(a,[c.partial(this.radix,this.getLimb(b))]);return a},bitLength:function(){this.fullReduce();for(var a=this.radix*(this.limbs.length-1),b=this.limbs[this.limbs.length-1];b;b>>=1)a++;return a+7&-8}};sjcl.bn.fromBits=function(a){var b=new this,c=[],d=sjcl.bitArray,e=this.prototype,f=Math.min(this.bitLength||4294967296,d.bitLength(a)),h=f%e.radix||e.radix;for(c[0]=d.extract(a,0,h);h<f;h+=e.radix)c.unshift(d.extract(a,h,e.radix));b.limbs=c;return b};
sjcl.bn.prototype.ipv=1/(sjcl.bn.prototype.placeVal=Math.pow(2,sjcl.bn.prototype.radix));sjcl.bn.prototype.radixMask=(1<<sjcl.bn.prototype.radix)-1;
sjcl.bn.pseudoMersennePrime=function(a,b){function c(a){this.initWith(a)}var d=c.prototype=new sjcl.bn,e,f;e=d.modOffset=Math.ceil(f=a/d.radix);d.exponent=a;d.offset=[];d.factor=[];d.minOffset=e;d.fullMask=0;d.fullOffset=[];d.fullFactor=[];d.modulus=c.modulus=new sjcl.bn(Math.pow(2,a));d.fullMask=0|-Math.pow(2,a%d.radix);for(e=0;e<b.length;e++)d.offset[e]=Math.floor(b[e][0]/d.radix-f),d.fullOffset[e]=Math.ceil(b[e][0]/d.radix-f),d.factor[e]=b[e][1]*Math.pow(0.5,a-b[e][0]+d.offset[e]*d.radix),d.fullFactor[e]=
b[e][1]*Math.pow(0.5,a-b[e][0]+d.fullOffset[e]*d.radix),d.modulus.addM(new sjcl.bn(Math.pow(2,b[e][0])*b[e][1])),d.minOffset=Math.min(d.minOffset,-d.offset[e]);d.d=c;d.modulus.cnormalize();d.reduce=function(){var a,b,c,d=this.modOffset,e=this.limbs,f=this.offset,x=this.offset.length,n=this.factor,w;for(a=this.minOffset;e.length>d;){c=e.pop();w=e.length;for(b=0;b<x;b++)e[w+f[b]]-=n[b]*c;a--;a||(e.push(0),this.cnormalize(),a=this.minOffset)}this.cnormalize();return this};d.S=-1===d.fullMask?d.reduce:
function(){var a=this.limbs,b=a.length-1,c,d;this.reduce();if(b===this.modOffset-1){d=a[b]&this.fullMask;a[b]-=d;for(c=0;c<this.fullOffset.length;c++)a[b+this.fullOffset[c]]-=this.fullFactor[c]*d;this.normalize()}};d.fullReduce=function(){var a,b;this.S();this.addM(this.modulus);this.addM(this.modulus);this.normalize();this.S();for(b=this.limbs.length;b<this.modOffset;b++)this.limbs[b]=0;a=this.greaterEquals(this.modulus);for(b=0;b<this.limbs.length;b++)this.limbs[b]-=this.modulus.limbs[b]*a;this.cnormalize();
return this};d.inverse=function(){return this.power(this.modulus.sub(2))};c.fromBits=sjcl.bn.fromBits;return c};
sjcl.bn.prime={p127:sjcl.bn.pseudoMersennePrime(127,[[0,-1]]),p25519:sjcl.bn.pseudoMersennePrime(255,[[0,-19]]),p192:sjcl.bn.pseudoMersennePrime(192,[[0,-1],[64,-1]]),p224:sjcl.bn.pseudoMersennePrime(224,[[0,1],[96,-1]]),p256:sjcl.bn.pseudoMersennePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:sjcl.bn.pseudoMersennePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sjcl.bn.pseudoMersennePrime(521,[[0,-1]])};
sjcl.bn.random=function(a,b){"object"!==typeof a&&(a=new sjcl.bn(a));for(var c,d,e=a.limbs.length,f=a.limbs[e-1]+1,h=new sjcl.bn;;){do c=sjcl.random.randomWords(e,b),0>c[e-1]&&(c[e-1]+=4294967296);while(Math.floor(c[e-1]/f)===Math.floor(4294967296/f));c[e-1]%=f;for(d=0;d<e-1;d++)c[d]&=a.radixMask;h.limbs=c;if(!h.greaterEquals(a))return h}};sjcl.ecc={};sjcl.ecc.point=function(a,b,c){void 0===b?this.isIdentity=!0:(this.x=b,this.y=c,this.isIdentity=!1);this.curve=a};
sjcl.ecc.point.prototype={toJac:function(){return new sjcl.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(a){return this.toJac().mult(a,this).toAffine()},mult2:function(a,b,c){return this.toJac().mult2(a,this,b,c).toAffine()},multiples:function(){var a,b,c;if(void 0===this.P){c=this.toJac().doubl();a=this.P=[new sjcl.ecc.point(this.curve),this,c.toAffine()];for(b=3;16>b;b++)c=c.add(this),a.push(c.toAffine())}return this.P},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},
toBits:function(){return sjcl.bitArray.concat(this.x.toBits(),this.y.toBits())}};sjcl.ecc.pointJac=function(a,b,c,d){void 0===b?this.isIdentity=!0:(this.x=b,this.y=c,this.z=d,this.isIdentity=!1);this.curve=a};
sjcl.ecc.pointJac.prototype={add:function(a){var b,c,d,e;if(this.curve!==a.curve)throw"sjcl['ecc']['add'](): Points must be on the same curve to add them!";if(this.isIdentity)return a.toJac();if(a.isIdentity)return this;b=this.z.square();c=a.x.mul(b).subM(this.x);if(c.equals(0))return this.y.equals(a.y.mul(b.mul(this.z)))?this.doubl():new sjcl.ecc.pointJac(this.curve);b=a.y.mul(b.mul(this.z)).subM(this.y);d=c.square();a=b.square();e=c.square().mul(c).addM(this.x.add(this.x).mul(d));a=a.subM(e);b=
this.x.mul(d).subM(a).mul(b);d=this.y.mul(c.square().mul(c));b=b.subM(d);c=this.z.mul(c);return new sjcl.ecc.pointJac(this.curve,a,b,c)},doubl:function(){if(this.isIdentity)return this;var a=this.y.square(),b=a.mul(this.x.mul(4)),c=a.square().mul(8),a=this.z.square(),d=this.x.sub(a).mul(3).mul(this.x.add(a)),a=d.square().subM(b).subM(b),b=b.sub(a).mul(d).subM(c),c=this.y.add(this.y).mul(this.z);return new sjcl.ecc.pointJac(this.curve,a,b,c)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new sjcl.ecc.point(this.curve);
var a=this.z.inverse(),b=a.square();return new sjcl.ecc.point(this.curve,this.x.mul(b).fullReduce(),this.y.mul(b.mul(a)).fullReduce())},mult:function(a,b){"number"===typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);var c,d=(new sjcl.ecc.point(this.curve)).toJac(),e=b.multiples();for(b=a.length-1;0<=b;b--)for(c=sjcl.bn.prototype.radix-4;0<=c;c-=4)d=d.doubl().doubl().doubl().doubl().add(e[a[b]>>c&15]);return d},mult2:function(a,b,c,d){"number"===typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);
"number"===typeof c?c=[c]:void 0!==c.limbs&&(c=c.normalize().limbs);var e,f=(new sjcl.ecc.point(this.curve)).toJac();b=b.multiples();var h=d.multiples(),l,m;for(d=Math.max(a.length,c.length)-1;0<=d;d--){l=a[d]|0;m=c[d]|0;for(e=sjcl.bn.prototype.radix-4;0<=e;e-=4)f=f.doubl().doubl().doubl().doubl().add(b[l>>e&15]).add(h[m>>e&15])}return f},isValid:function(){var a=this.z.square(),b=a.square(),a=b.mul(a);return this.y.square().equals(this.curve.b.mul(a).add(this.x.mul(this.curve.a.mul(b).add(this.x.square()))))}};
sjcl.ecc.curve=function(a,b,c,d,e,f){this.field=a;this.r=a.prototype.modulus.sub(b);this.a=new a(c);this.b=new a(d);this.G=new sjcl.ecc.point(this,new a(e),new a(f))};sjcl.ecc.curve.prototype.fromBits=function(a){var b=sjcl.bitArray,c=this.field.prototype.exponent+7&-8;a=new sjcl.ecc.point(this,this.field.fromBits(b.bitSlice(a,0,c)),this.field.fromBits(b.bitSlice(a,c,2*c)));if(!a.isValid())throw new sjcl.exception.corrupt("not on the curve!");return a};
sjcl.ecc.curves={c192:new sjcl.ecc.curve(sjcl.bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new sjcl.ecc.curve(sjcl.bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),
c256:new sjcl.ecc.curve(sjcl.bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new sjcl.ecc.curve(sjcl.bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7",
"0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),c521:new sjcl.ecc.curve(sjcl.bn.prime.p521,"0x5AE79787C40D069948033FEB708F65A2FC44A36477663B851449048E16EC79BF6",-3,"0x051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00","0xc6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66","0x11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")};
sjcl.ecc.K=function(a){sjcl.ecc[a]={publicKey:function(a,c,d){this.e=c;this.B=d instanceof Array?c.fromBits(d):d;a&&(this.V=a,this.serialize=function(){return{point:d.toBits(),curve:a}})},secretKey:function(a,c,d){this.e=c;this.w=d;a&&(this.V=a,this.serialize=function(){return{exponent:d.toBits(),curve:a}})},generateKeys:function(b,c){var d;void 0===b&&(b=256);if("number"===typeof b&&(d=b,b=sjcl.ecc.curves["c"+b],void 0===b))throw new sjcl.exception.invalid("no such curve");c=sjcl.bn.random(b.r,c);
var e=b.G.mult(c);return{pub:new sjcl.ecc[a].publicKey(d,b,e),sec:new sjcl.ecc[a].secretKey(d,b,c)}}}};sjcl.ecc.K("elGamal");sjcl.ecc.elGamal.publicKey.prototype={kem:function(a){a=sjcl.bn.random(this.e.r,a);var b=this.e.G.mult(a).toBits();return{key:sjcl.hash.sha256.hash(this.B.mult(a).toBits()),tag:b}}};sjcl.ecc.elGamal.secretKey.prototype={unkem:function(a){return sjcl.hash.sha256.hash(this.e.fromBits(a).mult(this.w).toBits())},dh:function(a){return sjcl.hash.sha256.hash(a.B.mult(this.w).toBits())}};
sjcl.ecc.K("ecdsa");sjcl.ecc.ecdsa.secretKey.prototype={sign:function(a,b){var c=this.e.r,d=c.bitLength(),e=sjcl.bn.random(c.sub(1),b).add(1);b=this.e.G.mult(e).x.mod(c);a=sjcl.bn.fromBits(a).add(b.mul(this.w)).inverseMod(c).mul(e).mod(c);return sjcl.bitArray.concat(b.toBits(d),a.toBits(d))}};
sjcl.ecc.ecdsa.publicKey.prototype={verify:function(a,b){var c=sjcl.bitArray,d=this.e.r,e=d.bitLength(),f=sjcl.bn.fromBits(c.bitSlice(b,0,e));b=sjcl.bn.fromBits(c.bitSlice(b,e,2*e));a=sjcl.bn.fromBits(a).mul(b).mod(d);c=f.mul(b).mod(d);a=this.e.G.mult2(a,c,this.B).x;if(f.equals(0)||b.equals(0)||f.greaterEquals(d)||b.greaterEquals(d)||!a.equals(f))throw new sjcl.exception.corrupt("signature didn't check out");return!0}};var entropyElemId="entropy",entropySufficientMessage="sufficient";
function eccCrypto(){this.init=function(a,b){entropyElemId=a;entropySufficientMessage=b;document.addEventListener("mousemove",this.update,!0);sjcl.random.startCollectors()};this.update=function(){var a=document.getElementById(entropyElemId),b=sjcl.random.getProgress(10);void 0===b?(a.innerHTML=entropySufficientMessage,sjcl.random.stopCollectors(),document.removeEventListener("mousemove",this.update)):a.innerHTML=b.toFixed(2)};this.generateKeypair=function(a){try{var b=sjcl.ecc.elGamal.generateKeys(a,
10),c=JSON.stringify(b.pub.serialize()),d=JSON.stringify(b.sec.serialize()),c=this.toBase64(c),d=this.toBase64(d);return{priv:d,pub:c}}catch(e){return null}};this.encryptString=function(a,b){try{for(var c=this.randomKeyString(),d=b.length,e=[],f=0;f<d;f++){var h=b[f],h=this.toUtf8(h),l=CryptoJS.SHA3(h,{outputLength:224}),l=l.toString(CryptoJS.enc.Base64),m=JSON.parse(h),g=sjcl.ecc.curves["c"+m.curve].fromBits(m.point),p=(new sjcl.ecc.elGamal.publicKey(m.curve,g.curve,g)).kem(0),q=p.key,x=JSON.stringify(p.tag),
n=JSON.stringify(this.encrypt(c,q)),x=this.toBase64(x),n=this.toBase64(n);e.push({pubkey:l,cipherkey:n,keytag:x})}var w=CryptoJS.AES.encrypt(a,c);return{ciphertext:w+"",enckeys:e}}catch(y){return null}};this.encryptAndSignString=function(a,b,c){try{c=this.toUtf8(c);var d=JSON.parse(c),e=sjcl.bn.fromBits(d.exponent),f=new sjcl.ecc.ecdsa.secretKey(d.curve,sjcl.ecc.curves["c"+d.curve],e),h=this.hashMessage(a),l=f.sign(h,0),m=JSON.stringify(l),m=this.toBase64(m),g=this.encryptString(a,b);return{ciphertext:g.ciphertext,
enckeys:g.enckeys,signature:m}}catch(p){return null}};this.decryptString=function(a,b,c,d){try{b=this.toUtf8(b);c=this.toUtf8(c);d=this.toUtf8(d);var e=this.decryptSymKey(c,d),f=this.decryptText(b,e),h=CryptoJS.AES.decrypt(a,f),h=h.toString(CryptoJS.enc.Utf8);return{cleartext:h}}catch(l){return null}};this.decryptAndVerifyString=function(a,b,c,d,e,f){try{e=this.toUtf8(e);f=this.toUtf8(f);var h=JSON.parse(e),l=sjcl.ecc.curves["c"+h.curve].fromBits(h.point),m=new sjcl.ecc.ecdsa.publicKey(h.curve,l.curve,
l),g=JSON.parse(f),p=this.decryptString(a,b,c,d).cleartext,q=this.hashMessage(p);a=!1;try{a=m.verify(q,g)}catch(x){a=!1}m="unverified";a&&(m="verified");return{cleartext:p,verified:m}}catch(n){return null}};this.signString=function(a,b){try{b=this.toUtf8(b);var c=JSON.parse(b),d=sjcl.bn.fromBits(c.exponent),e=new sjcl.ecc.ecdsa.secretKey(c.curve,sjcl.ecc.curves["c"+c.curve],d),f=this.hashMessage(a),h=e.sign(f,0),l=JSON.stringify(h),l=this.toBase64(l);return{message:a,signature:l}}catch(m){return null}};
this.verifySignature=function(a,b,c){try{b=this.toUtf8(b);c=this.toUtf8(c);var d=JSON.parse(c),e=sjcl.ecc.curves["c"+d.curve].fromBits(d.point),f=new sjcl.ecc.ecdsa.publicKey(d.curve,e.curve,e),h=JSON.parse(b),l=this.hashMessage(a);a=!1;try{a=f.verify(l,h)}catch(m){a=!1}f="unverified";a&&(f="verified");return{verified:f}}catch(g){return null}};this.randomKeyString=function(){for(var a="",b=64;0<b;--b)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.round(61*Math.random())];
a=CryptoJS.SHA3(a,{outputLength:384});a=a.toString(CryptoJS.enc.Base64);b=CryptoJS.SHA3(a,{outputLength:512});b=b.toString(CryptoJS.enc.Base64);a+=b;64<a.length&&(a=a.substr(0,63));return a};this.toBase64=function(a){return CryptoJS.enc.Utf8.parse(a).toString(CryptoJS.enc.Base64)};this.toUtf8=function(a){return CryptoJS.enc.Base64.parse(a).toString(CryptoJS.enc.Utf8)};this.hashMessage=function(a){a=CryptoJS.SHA512(a);a=a.toString(CryptoJS.enc.Hex);a=CryptoJS.SHA3(a,{outputLength:512});return a=a.toString(CryptoJS.enc.Base64)};
this.decryptSymKey=function(a,b){var c=JSON.parse(a),d=JSON.parse(b),e=sjcl.bn.fromBits(d.exponent);return(new sjcl.ecc.elGamal.secretKey(d.curve,sjcl.ecc.curves["c"+d.curve],e)).unkem(c)};this.decryptText=function(a,b){var c=JSON.parse(a),c=this.decrypt(c,b),c=this.binChars(this.decBin(c)),d="";for(i=0;i<c.length;i++)0!=c[i]&&(d+=String.fromCharCode(c[i]));return d};this.encrypt=function(a,b){return this.toAes(this.toDec(this.toBin(a)),b)};this.decrypt=function(a,b){return this.fromAes(a,b)};this.toAes=
function(a,b){aes=new sjcl.cipher.aes(b);crypt_arr=[];j=0;temp_arr=[];for(i=0;i<a.length;i++,j++){temp_arr[j]=a[i];if(i+1>=a.length)for(;4>temp_arr.length;)temp_arr[temp_arr.length]=null;4==temp_arr.length&&(temp_crypt=aes.encrypt(temp_arr,{ks:256,ts:128}),crypt_arr=crypt_arr.concat(temp_crypt),j=-1,temp_arr=[])}return crypt_arr};this.fromAes=function(a,b){aes=new sjcl.cipher.aes(b);plain_arr=[];j=0;temp_arr=[];for(i=0;i<a.length;i++,j++)temp_arr[j]=a[i],4==temp_arr.length&&(temp_plain=aes.decrypt(temp_arr,
{ks:256,ts:128}),plain_arr=plain_arr.concat(temp_plain),j=-1,temp_arr=[]);return plain_arr};this.decBin=function(a){var b="";for(i=0;i<a.length;i++){for(temp_bin=parseInt(a[i]).toString(2);16>temp_bin.length;)temp_bin="0"+temp_bin;b+=temp_bin}return b};this.binChars=function(a){char_arr=[];len=a.length;val=1;dec=0;for(i=1;i<=len;i++)1==parseInt(a[len-i])&&(dec+=val),val*=2,1!=i&&0==i%8&&(char_arr[char_arr.length]=dec,val=1,dec=0);char_arr.reverse();return char_arr};this.toBin=function(a){var b,c,
d,e=[],f=a.length;for(b=1;b<=f;b++){d=a.charCodeAt(f-b);for(c=0;8>c;c++)e.push(d%2),d=Math.floor(d/2)}return ret=e.reverse().join("")};this.toDec=function(a){var b=[];j=0;temp_arr=[];for(i=0;i<a.length;i++,j++){temp_arr[j]=a[i];if(i+1==a.length)for(;16>temp_arr.length;)pad=[0],temp_arr=temp_arr.concat(pad);if(16==temp_arr.length){dec=0;for(k=val=1;k<=temp_arr.length;k++)1==parseInt(temp_arr[temp_arr.length-k])&&(dec+=val),val*=2;b[b.length]=dec;j=-1;temp_arr=[]}}return b}}var eccCryptoScheme=new eccCrypto;var cipherScriptFunctions=new cipherScriptF;
function cipherScriptF(){this.init=function(a,b){eccCryptoScheme.init(a,b)};this.generateKeypair=function(a,b){try{var c=eccCryptoScheme.generateKeypair(a),d=c.pub,e=c.priv,e=this.symEncrypt(e,b);return{privkey:"<privkey><key>"+e+"</key></privkey>",pubkey:"<pubkey><key>"+d+"</key></pubkey>"}}catch(f){return null}};this.encryptMessage=function(a,b){try{for(var c=[],d=0;d<b.length;d++){var e=b[d].between("<key>","</key>");null!=e&&c.push(e)}for(var f=eccCryptoScheme.encryptString(a,c),h=f.ciphertext,
l=f.enckeys,c="<keyheader>",c=c+("<length>"+l.length+"</length>"),d=0;d<l.length;d++)c+="<header id='"+d.toString()+"'><keyhash>"+l[d].pubkey+"</keyhash><ciphkey>"+l[d].cipherkey+"</ciphkey><keytag>"+l[d].keytag+"</keytag></header>";return{message:"<message><type>encrypted</type>"+(c+"</keyheader>")+"<text>"+h+"</text></message>"}}catch(m){return null}};this.decryptMessage=function(a,b,c,d){try{for(var e=eccCryptoScheme.toUtf8(c.between("<key>","</key>")),f=CryptoJS.SHA3(e,{outputLength:224}),f=f.toString(CryptoJS.enc.Base64),
h=a.between("<keyheader>","</keyheader>"),l=h.between("<length>","</length>"),l=parseInt(l),m=e=c=null,g=0;g<l;g++){var p=h.between("<header id='"+g.toString()+"'>","</header>");c=p.between("<keyhash>","</keyhash>");if(c==f){e=p.between("<ciphkey>","</ciphkey>");m=p.between("<keytag>","</keytag>");break}}if(null==c||null==e||null==m)return null;b=b.between("<key>","</key>");b=this.symDecrypt(b,d);var q=a.between("<text>","</text>"),x=eccCryptoScheme.decryptString(q,e,m,b);return null==x?null:{cleartext:x.cleartext}}catch(n){return null}};
this.signMessage=function(a,b,c){try{if(1>a.length||1>b.length||1>c.length)return null;var d=b.between("<key>","</key>"),d=this.symDecrypt(d,c),e=eccCryptoScheme.signString(a,d);return null==e?null:{message:"<message><type>signed</type><text>"+e.message+"</text><signature>"+e.signature+"</signature></message>"}}catch(f){return null}};this.verifyMessage=function(a,b){try{if(1>a.length||1>b.length)return null;var c=a.between("<signature>","</signature>"),d=a.between("<text>","</text>"),e=b.between("<key>",
"</key>"),f=eccCryptoScheme.verifySignature(d,c,e),c="unverified";null!=f&&(c=f.verified);return{verified:c}}catch(h){return null}};this.encryptAndSignMessage=function(a,b,c,d){try{for(var e=[],f=0;f<b.length;f++){var h=b[f].between("<key>","</key>");null!=h&&e.push(h)}var l=eccCryptoScheme.encryptString(a,e),m=l.ciphertext,g=l.enckeys;b="<keyheader>";b+="<length>"+g.length+"</length>";for(e=0;e<g.length;e++)b+="<header id='"+e+"'><keyhash>"+g[e].pubkey+"</keyhash><ciphkey>"+g[e].cipherkey+"</ciphkey><keytag>"+
g[e].keytag+"</keytag></header>";b+="</keyheader>";var p=c.between("<key>","</key>"),p=this.symDecrypt(p,d),q=eccCryptoScheme.signString(a,p);return null==q?null:{message:"<message><type>encrypted,signed</type>"+b+"<text>"+m+"</text><signature>"+q.signature+"</signature></message>"}}catch(x){return null}};this.decryptAndVerifyMessage=function(a,b,c,d,e){try{for(var f=eccCryptoScheme.toUtf8(c.between("<key>","</key>")),h=CryptoJS.SHA3(f,{outputLength:224}),h=h.toString(CryptoJS.enc.Base64),l=a.between("<keyheader>",
"</keyheader>"),m=l.between("<length>","</length>"),m=parseInt(m),g=f=c=null,p=0;p<m;p++){var q=l.between("<header id='"+p.toString()+"'>","</header>");c=q.between("<keyhash>","</keyhash>");if(c==h){f=q.between("<ciphkey>","</ciphkey>");g=q.between("<keytag>","</keytag>");break}}if(null==c||null==f||null==g)return null;b=b.between("<key>","</key>");b=this.symDecrypt(b,d);var x=a.between("<text>","</text>"),n=eccCryptoScheme.decryptString(x,f,g,b);if(null==n)return null;var w=a.between("<signature>",
"</signature>"),y=n.cleartext,D=e.between("<key>","</key>"),A=eccCryptoScheme.verifySignature(y,w,D);a="unverified";null!=A&&(a=A.verified);return{cleartext:n.cleartext,verified:a}}catch(M){return null}};this.symEncrypt=function(a,b){var c=CryptoJS.AES.encrypt(a,b);return c+""};this.symDecrypt=function(a,b){var c=CryptoJS.AES.decrypt(a,b);return c=c.toString(CryptoJS.enc.Utf8)};this.improvePassword=function(a){a=CryptoJS.SHA512(a);a=a.toString(CryptoJS.enc.Base64);a=CryptoJS.SHA3(a,{outputLength:512});
a=a.toString(CryptoJS.enc.Base64);if(63>a.length){var b=CryptoJS.SHA3(a,{outputLength:384}),b=b.toString(CryptoJS.enc.Base64);a+=b}64<a.length&&(a=a.substr(0,63));return a};this.hash=function(a,b){var c=512;if("undefined"===!typeof b&&(224===b||256===b||384===b))c=b;c=CryptoJS.SHA3(a,{outputLength:c});return c=c.toString(CryptoJS.enc.Base64)}};var cipherScript=cipherScriptFunctions;cipherScript.init=cipherScriptFunctions.init;cipherScript.generateKeypair=cipherScriptFunctions.generateKeypair;cipherScript.encryptMessage=cipherScriptFunctions.encryptMessage;cipherScript.decryptMessage=cipherScriptFunctions.decryptMessage;cipherScript.signMessage=cipherScriptFunctions.signMessage;cipherScript.verifyMessage=cipherScriptFunctions.verifyMessage;cipherScript.encryptAndSignMessage=cipherScriptFunctions.encryptAndSignMessage;
cipherScript.decryptAndVerifyMessage=cipherScriptFunctions.decryptAndVerifyMessage;cipherScript.symEncrypt=cipherScriptFunctions.symEncrypt;cipherScript.symDecrypt=cipherScriptFunctions.symDecrypt;cipherScript.improvePassword=cipherScriptFunctions.improvePassword;cipherScript.hash=cipherScriptFunctions.hash;cipherScript.randomKeyString=eccCryptoScheme.randomKeyString;cipherScript.toBase64=eccCryptoScheme.toBase64;cipherScript.toUtf8=eccCryptoScheme.toUtf8;cipherScript.ecc=eccCryptoScheme;
cipherScript.ecc.generateKeypair=eccCryptoScheme.generateKeypair;cipherScript.ecc.encryptString=eccCryptoScheme.encryptString;cipherScript.ecc.encryptAndSignString=eccCryptoScheme.encryptAndSignString;cipherScript.ecc.decryptString=eccCryptoScheme.decryptString;cipherScript.ecc.decryptAndVerifyString=eccCryptoScheme.decryptAndVerifyString;cipherScript.ecc.signString=eccCryptoScheme.signString;cipherScript.ecc.verifySignature=eccCryptoScheme.verifySignature;
